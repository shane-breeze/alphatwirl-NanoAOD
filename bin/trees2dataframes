#!/usr/bin/env python
import os
import click
import alphatwirl_nanoaod.read_trees as t2df

@click.command()
@click.argument("in_path")
@click.option("-o", "--out_dir", default=os.path.join(os.getcwd(), "output"),
        help="The path to an output directory, which should exist")
@click.option("-n", "--events-per-dataset", default=-1, type=int,
        help="Limit the number of events per dataset")
@click.option("-N", "--events-per-process", default=-1, type=int,
        help="Limit the number of events per process (condor job)")
@click.option("--n-files", default=1, type=int,
        help="Number of files per run")
@click.option('--components', default="all",
        help="Select which NanoAOD components to read."
             "Use 'all' to read everything")
@click.option('--mode', default="multiprocessing",
        help="Choose which parallel mode to run in")
@click.option('--ncores', default=4,
        help="Choose the number of cores to run on in multiprocessing mode")

def main(**kwargs):
    """
    Produce binned dataframes summarizing either data or MC components.
    Makes the first set of dataframes for the analysis chain.
    """

    if "components" in kwargs:
        kwargs["components"] = kwargs["components"].split()
    t2df.main(**kwargs)

if __name__ == "__main__":
    main()
